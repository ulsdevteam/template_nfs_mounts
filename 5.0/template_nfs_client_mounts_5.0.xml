<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2025-10-02T13:00:14Z</date>
    <groups>
        <group>
            <name>Templates/Operating systems</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template NFS Client Mounts</template>
            <name>Template NFS Client Mounts</name>
            <groups>
                <group>
                    <name>Templates/Operating systems</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <name>NFS mounts discovery</name>
                    <key>nfs.discovery</key>
                    <delay>1h</delay>
                    <description>Discovers active NFS mounts and their servers.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] accessibility</name>
                            <key>nfs.mount.check[{#MOUNTPOINT}]</key>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;&gt;0</expression>
                                    <name>NFS mount {#MOUNTPOINT} is not accessible</name>
                                    <priority>HIGH</priority>
                                    <description>The mount is stale or unresponsive.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] age (seconds)</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},age]</key>
                            <units>seconds</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;300</expression>
                                    <name>Recent remount on NFS mount {#MOUNTPOINT} (age &lt;5min)</name>
                                    <priority>WARNING</priority>
                                    <description>Mount may have been recently remounted.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] total bytes read</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},bytes_read]</key>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] total bytes written</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},bytes_written]</key>
                            <units>B</units>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] commit operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},commit]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High commit rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive commit operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] create operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},create]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High create rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive create operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] fsinfo operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},fsinfo]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High fsinfo rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive fsinfo operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] fsstat operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},fsstat]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=0</expression>
                                    <name>High fsstat rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive fsstat operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] getattr operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},getattr]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High getattr rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive getattr operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] link operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},link]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High link rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive link operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] mkdir operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},mkdir]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High mkdir rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive mkdir operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] mknod operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},mknod]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] pathconf operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},pathconf]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High pathconf rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive pathconf operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] readdirplus operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},readdirplus]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High readdirplus rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive readdirplus operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] readdir operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},readdir]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High readdir rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive readdir operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] read operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},read]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] remove operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},remove]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High remove rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive remove operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] rename operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},rename]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High rename rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive rename operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] total retransmissions</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},retrans_total]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;0.1</expression>
                                    <name>High retransmission rate on NFS mount {#MOUNTPOINT} (&gt;0.1/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive retransmissions may indicate network issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] rmdir operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},rmdir]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High rmdir rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive rmdir operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] setattr operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},setattr]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High setattr rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive setattr operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] symlink operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},symlink]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;100</expression>
                                    <name>High symlink rate on NFS mount {#MOUNTPOINT} (&gt;100/sec)</name>
                                    <priority>WARNING</priority>
                                    <description>Excessive symlink operations may indicate application issues.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] write operations</name>
                            <key>nfs.mount.stat[{#MOUNTPOINT},write]</key>
                            <preprocessing>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS server [{#SERVER}] connection</name>
                            <key>nfs.server.check[{#SERVER}]</key>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;&gt;0</expression>
                                    <name>NFS connection to server {#SERVER} failed</name>
                                    <priority>HIGH</priority>
                                    <description>Cannot connect to NFS service on the server.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] free space</name>
                            <key>vfs.fs.size[{#MOUNTPOINT},free]</key>
                            <units>B</units>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] free space (%)</name>
                            <key>vfs.fs.size[{#MOUNTPOINT},pfree]</key>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;10</expression>
                                    <name>Low free space on NFS mount {#MOUNTPOINT} (&lt;10%)</name>
                                    <priority>HIGH</priority>
                                    <description>Free space is below 10%.</description>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] total space</name>
                            <key>vfs.fs.size[{#MOUNTPOINT},total]</key>
                            <units>B</units>
                        </item_prototype>
                        <item_prototype>
                            <name>NFS mount [{#MOUNTPOINT}] used space</name>
                            <key>vfs.fs.size[{#MOUNTPOINT},used]</key>
                            <units>B</units>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>NFS Data Transfer on {#MOUNTPOINT}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>00CC00</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},read]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>CC0000</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},write]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>NFS Filesystem Usage on {#MOUNTPOINT}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>00CC00</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>vfs.fs.size[{#MOUNTPOINT},pfree]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>NFS Operations on {#MOUNTPOINT}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>00CC00</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},getattr]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>CC0000</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},setattr]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>0000CC</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},read]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FF9900</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},write]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>660066</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},create]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>6</sortorder>
                                    <color>33CCCC</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},mkdir]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>7</sortorder>
                                    <color>CC33CC</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},remove]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>8</sortorder>
                                    <color>FF3333</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},rmdir]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>9</sortorder>
                                    <color>33FF33</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},rename]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>10</sortorder>
                                    <color>3333FF</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},link]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>11</sortorder>
                                    <color>FFFF33</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},readdir]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>12</sortorder>
                                    <color>33FFFF</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},readdirplus]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>NFS Retransmissions on {#MOUNTPOINT}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>CC0000</color>
                                    <item>
                                        <host>Template NFS Client Mounts</host>
                                        <key>nfs.mount.stat[{#MOUNTPOINT},retrans_total]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
    </templates>
</zabbix_export>
